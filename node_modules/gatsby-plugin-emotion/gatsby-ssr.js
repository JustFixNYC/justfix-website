"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _server = require("react-dom/server");

var _emotionServer = require("emotion-server");

exports.replaceRenderer = function (_ref) {
  var bodyComponent = _ref.bodyComponent,
      replaceBodyHTMLString = _ref.replaceBodyHTMLString,
      setHeadComponents = _ref.setHeadComponents;

  var _extractCritical = (0, _emotionServer.extractCritical)((0, _server.renderToString)(bodyComponent)),
      html = _extractCritical.html,
      ids = _extractCritical.ids,
      css = _extractCritical.css;

  var criticalStyle = _react.default.createElement("style", {
    dangerouslySetInnerHTML: {
      __html: css
    }
  });

  var criticalIds = _react.default.createElement("script", {
    dangerouslySetInnerHTML: {
      __html: "window.__EMOTION_CRITICAL_CSS_IDS__ = " + JSON.stringify(ids) + ";"
    }
  });

  setHeadComponents([criticalIds, criticalStyle]);
  replaceBodyHTMLString(html);
};